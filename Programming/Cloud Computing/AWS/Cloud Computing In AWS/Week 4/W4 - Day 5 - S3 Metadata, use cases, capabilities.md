[[S3]] [[Storage]] [[Healthcare]] [[DICOM]] [[Metadata]]
# S3 Metadata

Metadata categories:
- System defined -> size, creation date time, last modified, etc. 
	- It has to do with information that is generated by the system. Think about what you see in a file explorer
- User defined -> Here, anything goes, the pdf describes an example where a user defines 
- Event related -> lifecycle related, version, data transfer event, security scan

The above information can be accessed through *Amazon Athena - SQL based querying*

*Metadata* -> Data about data 
- Metadata brings order to huge amounts of data that is stored in cloud. 
- Apache Iceberg tables contain the metadata
- Metadata is managed directly and access through AWS services
- Easy integration with other services - meaning, other AWS services can easily access this metadata

## Challenges in data discovery 
Metadata contains useful information, but you need to use other AWS services (AWS Glue Data Catalog, Amazon Athena, Amazon OpenSearch) to fully optimize metadata management
- So, S3 metadata management requires other services in addition to S3 
- Today, businesses produce huge amounts of data. There is a challenge in finding and utilizing specific information 

Imagine keeping up with the billions of information that is generated. It becomes humanly impossible. 

### Diversity of data

- Structured -> Tabular 
- Unstructured -> Videos, Images, docs
- Semi structured -> Json, XML, etc. 

Each of these contains useful but different metadata, making unified management complex. 

#### Problem with external tracking system 
It becomes an unorganized mess, information quickly becomes outdated. If multiple systems are used, there will be unsynchronized information, you also have to account for time invested in maintaining these systems. 
- Automation is the key to solve this problem

Original/first designed tracking systems were not built for the scale of cloud computing.
- can't handle millions of simultaneous operations
- lack of real time update capabilities
- can't scale horizontally - I imagine it is hard to have a cluster of computers all linked up to this management system
- Limited query performance
- bottlenecks 

plus managing this manually requires a lot of time that can be spent elsewhere. 

## Amazon S3 metadata solution
AWS created Amazon S3 metadata native feature that:
- Automatically captures metadata - in apache iceberg tables
- maintains consistency
- scales seamlessly
- integrates directly

*If you want to manage or query this data, you need an additional service*

The storage of the metadata happens in a designated S3 table bucket 


*Apache Iceberg Tables* -> are perfecto for storing metadata because:
- Handles schema evolution as reqs change
- Provides transaction guarantees for consistency
- High performance
	-  Partitioning happens to ensure optimal performance
		- partitioning happens by date or other *high cardinality attribute* -> column with large number of unique values
- Works with existing analytics infrastructure
- Versioning -> different from what I am used to where tables don't have versions or a history
- Schema evolution -> if table structure changes, the tables can adapt
### Capturing process:

The capturing happens automatically 

![[Pasted image 20250701141634.png]]


### You must enable metadata collection

In the management console you can enable this for the S3 bucket you want to collect metadata in. Also, you can set up additional options:
- Which metadata attributes to collect
- How frequently 
- Permissions
- Retention policies

Once this is setup, you don't need additional setup. Everything happens automatically. 

Synchronization of your S3 bucket and your metadata apache iceberg tables is ensured. 

## Analytics Integration
You can integrate your metadata with Amazon QuickSight in order to produce BI analytics quickly and answer any questions the organization might have

# Metadata Use Case - Media Company
Media company produces millions of image assets in S3, images, photography, archive, user generated content, etc. 

Without metadata set up, it would be really hard - and costly - to find the right asset. 

## Solution with metadata

After implementing metadata:
- *Asset Discovery* -> Photographers can find any image easily with a query
```
SELECT object_key FROM metadata_table
WHERE user_metadata['camera_model'] = 'Canon EOS R5'
AND last_modified_date BETWEEN '2023-06-01' AND '2023-06-30';
```

- *Storage optimization* -> The media company can identify which objects are heavier and rarely accessed. Then they can be moved to archive to reduce cost. 
	- To do this you can also query the size:
```
SELECT COUNT(*), SUM(size_bytes)/1024/1024/1024 as "Size in GB"
FROM metadata_table
WHERE last_accessed_date < CURRENT_DATE - INTERVAL '180' DAY
AND storage_class = 'STANDARD';
```

- *Workflow Automation* -> you can create a query and ingest the result to Amazon QuickSight
- *Compliance Reporting* -> same goes for compliance, you can generate queries that produce reports that show what assets/data have sensitive info 

# Metadata Use Case - Healthcare - Medical Images 
Healthcare institutions produce massive volumes of medical imaging data that require careful organization and management 

- *Medical Imaging management* -> hospitals, clinics and diagnostic centers store vast amounts of *DICOM* (Digital Imaging and Communications in Medicine) files from X-rays, MRIs, CT scans and ultrasounds. 
	- These files reach several gigabytes in size and must be retained for years or decades

- *Advanced Tagging System* -> Using S3 metadata, healthcare providers can implement sophisticated tagging systems that categorize images based on multiple parameters:
	- patient id 
	- physician name (provider name)
	- body part
	- scan type (code)
	- imaging device
	- acquisition date 
	- service & post date
		- This granular classification enables medical staff to quickly locate specific images when needed for diagnosis or treatment 

- *Regulatory Compliance* -> S3 metadata can help with HIPAA regulation because you track changes to files such as:
	- Who accessed the object and when 
	- Encryption status and method used 
	- Data retention policies and expiration dates 
	- Audit trails for regulatory inspection 
	- Makes sure you keep files for the required time period

- *Research Applications* -> Medical researchers can use metadata to identify and retrieve specific categories of anonymized images for clinical studies without having to manually sort through entire databases 


## S3 Provides Storage Optimization 

Helps identify duplicates

Orphaned object detection -> if files/objects are no longer references by the application 

Large file analysis -> targets large files 

Version control optimization -> identifies objects with excessive version histories 

